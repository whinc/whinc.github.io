<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">10 分钟理解 Redux | whincwu(右耳朵猫)</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://whinc.github.io/blog/2018/02/26/understand-redux-in-10min"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="keywords" contentt="whinc, whincwu, 右耳朵猫"><meta data-rh="true" property="og:title" content="10 分钟理解 Redux | whincwu(右耳朵猫)"><meta data-rh="true" name="description" content="redux 是什么？"><meta data-rh="true" property="og:description" content="redux 是什么？"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2018-02-26T00:00:00.000Z"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://whinc.github.io/blog/2018/02/26/understand-redux-in-10min"><link data-rh="true" rel="alternate" href="https://whinc.github.io/blog/2018/02/26/understand-redux-in-10min" hreflang="en"><link data-rh="true" rel="alternate" href="https://whinc.github.io/blog/2018/02/26/understand-redux-in-10min" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://96Z44D671Y-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="whincwu(右耳朵猫) RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="whincwu(右耳朵猫) Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="whincwu(右耳朵猫) JSON Feed">



<link rel="search" type="application/opensearchdescription+xml" title="whincwu(右耳朵猫)" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.8a759e04.css">
<link rel="preload" href="/assets/js/runtime~main.1dbb5de3.js" as="script">
<link rel="preload" href="/assets/js/main.2d289e26.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_QvM7" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Logo" class="themedImage_B7nD themedImage--light_LnGU"><img src="/img/logo.png" alt="Logo" class="themedImage_B7nD themedImage--dark_PMgU"></div><b class="navbar__title text--truncate">whincwu(右耳朵猫)</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">博客</a><a class="navbar__item navbar__link" href="/docs/showcase/">作品</a><a class="navbar__item navbar__link" href="/tools">工具</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/about">关于我</a><a href="https://github.com/whinc/blog" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="searchBox_xTJW"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><div class="toggle_Mogd colorModeToggle_sZqO"><button class="clean-btn toggleButton_FBNX toggleButtonDisabled_gBi8" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_Zd0f"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_rajA"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_X5gH"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_HZy7 thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_twdc margin-bottom--md">全部文章</div><ul class="sidebarItemList_uSpR clean-list"><li class="sidebarItem_NVHW"><a class="sidebarItemLink_RugU" href="/blog/2023/04/05/knex-tutorial">Knex.js 教程</a></li><li class="sidebarItem_NVHW"><a class="sidebarItemLink_RugU" href="/blog/2023/03/04/antd-create-modal">Ant Design 弹窗封装：易用性和可维护性</a></li><li class="sidebarItem_NVHW"><a class="sidebarItemLink_RugU" href="/blog/2023/03/04/how-to-setup-blog">搭建博客站点</a></li><li class="sidebarItem_NVHW"><a class="sidebarItemLink_RugU" href="/blog/2020/11/25/usehash">自定义 hooks - useHash</a></li><li class="sidebarItem_NVHW"><a class="sidebarItemLink_RugU" href="/blog/2020/02/24/glob">glob 模式匹配教程</a></li><li class="sidebarItem_NVHW"><a class="sidebarItemLink_RugU" href="/blog/2019/07/30/setup-js-project">JavaScript 项目必备配置</a></li><li class="sidebarItem_NVHW"><a class="sidebarItemLink_RugU" href="/blog/2019/03/12/web-router-principle">Web 前端路由原理解析和实现</a></li><li class="sidebarItem_NVHW"><a class="sidebarItemLink_RugU" href="/blog/2018/12/10/vue-component-lifecycle">Vue 生命周期梳理</a></li><li class="sidebarItem_NVHW"><a class="sidebarItemLink_RugU" href="/blog/2018/09/29/take-photo-by-based-on-h5-miniprogram">H5 和小程序拍照图片旋转、压缩和上传</a></li><li class="sidebarItem_NVHW"><a class="sidebarItemLink_RugU" href="/blog/2018/08/06/save-photo-pitfall">H5 实现保存图片的采坑记录</a></li><li class="sidebarItem_NVHW"><a class="sidebarItemLink_RugU" href="/blog/2018/03/16/name-program-variable">程序变量命名的几种叫法</a></li><li class="sidebarItem_NVHW"><a aria-current="page" class="sidebarItemLink_RugU sidebarItemLinkActive_p57Z" href="/blog/2018/02/26/understand-redux-in-10min">10 分钟理解 Redux</a></li><li class="sidebarItem_NVHW"><a class="sidebarItemLink_RugU" href="/blog/2018/02/25/implement-promise">自己动手实现 ES6 Promise</a></li><li class="sidebarItem_NVHW"><a class="sidebarItemLink_RugU" href="/blog/2018/02/25/switch-react-component-theme-dynamically">React UI 组件库换肤设计思路</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_dByM" itemprop="headline">10 分钟理解 Redux</h1><div class="container_cfWM margin-vert--md"><time datetime="2018-02-26T00:00:00.000Z" itemprop="datePublished">February 26, 2018</time> · <!-- -->13 min read</div></header><div id="post-content" class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar__8zn" id="redux-是什么">redux 是什么？<a href="#redux-是什么" class="hash-link" aria-label="Direct link to redux 是什么？" title="Direct link to redux 是什么？">​</a></h2><p>redux 是一个前端状态管理库。</p><p>为什么要搞个状态管理库来增加复杂度和学习成本呢？这样讲没错，简单的项目用 redux 就是折腾自己，我也不建议你用，但是大一点项目，尤其是多人协作时，就完全是另一回事了。</p><p>随着 JavaScript 单页应用开发日趋复杂，JavaScript 需要管理比任何时候都要多的 state(状态)。 这些 state 可能包括服务器响应、缓存数据、本地生成尚未持久化到服务器的数据，也包括 UI 状态，如激活的路由，被选中的标签，是否显示加载动效或者分页器等等。</p><p>管理不断变化的 state 非常困难。如果一个 model 的变化会引起另一个 model 变化，那么当 view 变化时，就可能引起对应 model 以及另一个 model 的变化，依次地，可能会引起另一个 view 的变化。直至你搞不清楚到底发生了什么。state 在什么时候？由于什么原因？如何变化？已然不受控制。 当系统变得错综复杂的时候，想重现问题或者添加新功能就会变得举步维艰。</p><p>举个例子，一个登录页面有账号输入框、密码输入框和登录按钮，现在要实现，输入的密码符合条件时，登录按钮高亮可点击，不符合条件时，登录按钮置灰不可点击，同时显示提示信息。这里需要三个变量来表示页面 state：password（密码）、canLogin(按钮是否可用)和 hasInfo(提示信息是否显示)。</p><p><img loading="lazy" src="data:image/png;base64,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" width="236" height="240" class="img_cbWx"></p><p>为了实现这个功能，你需要监听输入框的变化事件，检测到变化时，就判断 password 是否符合条件，然后更新 canLogin 和 hasInfo 状态。</p><div class="language-javascript codeBlockContainer_y2BJ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sTVe"><pre tabindex="0" class="prism-code language-javascript codeBlock_E3kc thin-scrollbar"><code class="codeBlockLines_onph"><span class="token-line" style="color:#393A34"><span class="token plain">password</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;change&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  canLogin </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  hasInfo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_VXKq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lm29" aria-hidden="true"><svg class="copyButtonIcon_ASo7" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_WQFn" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>很多人觉得这个很简单啊，OK，这里逻辑再加上账户输入框的变化时，也更新按钮和提示状态呢？如果再加上账户输入时，要实时后台校验是否已注册，然后更新按钮和提示状态呢？如果这个页面再复杂一点呢？</p><div class="language-javascript codeBlockContainer_y2BJ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sTVe"><pre tabindex="0" class="prism-code language-javascript codeBlock_E3kc thin-scrollbar"><code class="codeBlockLines_onph"><span class="token-line" style="color:#393A34"><span class="token plain">username</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;change&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  canLogin </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  hasInfo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">login</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">setTimeout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    canLogin </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hasInfo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token spread operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// more code may modify state &#x27;canLogin&#x27; and &#x27;hasInfo&#x27; ...</span><br></span></code></pre><div class="buttonGroup_VXKq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lm29" aria-hidden="true"><svg class="copyButtonIcon_ASo7" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_WQFn" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这个时候，当你发现按钮无法点击，需要排查原因时，你很难快速找出 canLogin 是由于哪个因素引起的。</p><p>这里的复杂性很大程度上来自于，我们总是将两个难以理清的概念混淆在一起：<strong>变化</strong>和<strong>异步</strong>。通过限制更新发生的时间和方式，<strong>Redux 试图让 state 的变化变得可预测</strong>。这些限制条件反映在 Redux 的三大原则中（后面提到）。</p><p>说了这么多，可能还是不知道 redux 是什么，但至少知道 redux 似乎可以解决上面这个状态管理的问题。抽象的东西结合实践比较容易理解，接下来看下 redux 的核心概念和具体使用方法。</p><h2 class="anchor anchorWithStickyNavbar__8zn" id="redux-核心概念">redux 核心概念<a href="#redux-核心概念" class="hash-link" aria-label="Direct link to redux 核心概念" title="Direct link to redux 核心概念">​</a></h2><p>redux 本身非常简单，它只有三个核心概念：<strong>state</strong>、<strong>action</strong>和<strong>reducer</strong>，三者的关系如下图：</p><p><img loading="lazy" src="/assets/images/reducer-action-state-46e34d0ee56112f28c8eadc8200b2ee5.png" width="772" height="392" class="img_cbWx"></p><p>state 保存了应用程序当前状态，每当 state 发生变化时触发状态变化事件，事件的订阅者 View 拿到最新的 state 重新渲染 UI 以反映最新的 state 信息。</p><p>action 表示一个操作（请求修改 state 的操作），它是一个纯 JavaScript 对象，其包含了操作的类型、数据和元数据信息。用户与 View 进行交互，例如点击按钮、输入信息或页面跳转等，每个操作都会触发一个 action，网络请求、定时任务或系统其他异步事件，也会触发 action。所有 action 都会被送到一个称为 reducer 的处理函数。</p><p>reducer 是一个纯函数，其接受 state 和 action 作为输入，处理后返回一个新的 state，新的 state 会更新覆盖之前的 state 作为应用程序当前最新 state，并触发 state 变化事件。</p><p>上面就是 redux 核心思想：数据的流动是单向的，View 不直接操作 state，所有对 state 修改都通过发送 action 进行，action 统一由纯函数 reducer 进行处理，因此只有 reducer 能修改 state。redux 通过这些约束，让数据的变化变得可预测、可回溯。</p><p>下面结合一个 TODOs demo 看看 redux 是如何工作的？</p><p><img loading="lazy" src="/assets/images/redux-todos-demo-4c831548c9db807db74a46284bc8ca26.png" width="393" height="308" class="img_cbWx"></p><p><strong>state</strong></p><p>redux 的 state 是一个纯 JavaScript 对象，用于保存应用的状态数据。在 TODOs 应用中，state 保存了 todo 数组，每条 todo 都包含了内容和是否完成的标记，同时还有一个 visibilityFilter 标记用于过滤已完成的或未完成的 todos。</p><div class="language-javascript codeBlockContainer_y2BJ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sTVe"><pre tabindex="0" class="prism-code language-javascript codeBlock_E3kc thin-scrollbar"><code class="codeBlockLines_onph"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">todos</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">text</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Eat food&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">completed</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">text</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Exercise&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">completed</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">visibilityFilter</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SHOW_COMPLETED&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_VXKq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lm29" aria-hidden="true"><svg class="copyButtonIcon_ASo7" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_WQFn" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>action</strong></p><p>要想更新 state 中的数据，你需要发起一个 action，action 是一个普通 JavaScript 对象，用来描述发生了什么。在 TODO 应用中，定义了三种 action：新增 todo、切换 todo 状态和修改 todo 过滤显示状态。</p><div class="language-javascript codeBlockContainer_y2BJ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sTVe"><pre tabindex="0" class="prism-code language-javascript codeBlock_E3kc thin-scrollbar"><code class="codeBlockLines_onph"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 新增一个 TODO</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ADD_TODO&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">text</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Go to swimming pool&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 切换一个 TODO 的完成状态</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;TOGGLE_TODO&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">index</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 显示所有状态（完成和未完成）的 TODO</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SET_VISIBILITY_FILTER&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">filter</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SHOW_ALL&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_VXKq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lm29" aria-hidden="true"><svg class="copyButtonIcon_ASo7" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_WQFn" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><blockquote><p>强制使用 action 来描述所有变化带来的好处是可以清晰地知道应用中到底发生了什么。如果一些东西改变了，就可以知道为什么变。</p></blockquote><p><strong>reducer</strong></p><p>reducer 是一个纯函数，它接收两个参数 state 和 action，并返回<strong>新的 state</strong>，用伪代码描述：</p><div class="language-javascript codeBlockContainer_y2BJ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sTVe"><pre tabindex="0" class="prism-code language-javascript codeBlock_E3kc thin-scrollbar"><code class="codeBlockLines_onph"><span class="token-line" style="color:#393A34"><span class="token function-variable function" style="color:#d73a49">reducer</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">state</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> new_state</span><br></span></code></pre><div class="buttonGroup_VXKq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lm29" aria-hidden="true"><svg class="copyButtonIcon_ASo7" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_WQFn" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在 TODO 应用中，reducer 接收到 action 后，计算并返回新的 state。</p><div class="language-javascript codeBlockContainer_y2BJ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sTVe"><pre tabindex="0" class="prism-code language-javascript codeBlock_E3kc thin-scrollbar"><code class="codeBlockLines_onph"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">todoApp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">state </span><span class="token parameter operator" style="color:#393A34">=</span><span class="token parameter"> </span><span class="token parameter punctuation" style="color:#393A34">{</span><span class="token parameter punctuation" style="color:#393A34">}</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">todos</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">todos</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">todos</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">visibilityFilter</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">visibilityFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">visibilityFilter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_VXKq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lm29" aria-hidden="true"><svg class="copyButtonIcon_ASo7" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_WQFn" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-javascript codeBlockContainer_y2BJ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sTVe"><pre tabindex="0" class="prism-code language-javascript codeBlock_E3kc thin-scrollbar"><code class="codeBlockLines_onph"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">todos</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">state </span><span class="token parameter operator" style="color:#393A34">=</span><span class="token parameter"> </span><span class="token parameter punctuation" style="color:#393A34">[</span><span class="token parameter punctuation" style="color:#393A34">]</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> action</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ADD_TODO&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">text</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> action</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">completed</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">case</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;TOGGLE_TODO&#x27;</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">todo</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> index</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      action</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">index</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> index </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">text</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> todo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">text</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">completed</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">todo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">completed</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        todo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword module" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_VXKq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lm29" aria-hidden="true"><svg class="copyButtonIcon_ASo7" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_WQFn" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-javascript codeBlockContainer_y2BJ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sTVe"><pre tabindex="0" class="prism-code language-javascript codeBlock_E3kc thin-scrollbar"><code class="codeBlockLines_onph"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">visibilityFilter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SHOW_ALL&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> action</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">type</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SET_VISIBILITY_FILTER&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> action</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">filter</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">else</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_VXKq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lm29" aria-hidden="true"><svg class="copyButtonIcon_ASo7" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_WQFn" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>为了提高代码可维护性，对于每个字段的更新，可以抽取出粒度更小的 reducer 来完成，例如 <code>todoApp()</code>更新整个 state，内部又调用<code>todo()</code>更新<code>state.todos</code>字段，调用<code>visibilityFilter()</code>更新<code>state.visibilityFilter</code>字段。通过这种方式，我们可以根据不同的模块定义 reducer，每个reducer 只负责处理各自模块的 state 更新，最终将不同模块的 reducer 的处理结果合并成一个 reducer，下面是这个过程的示意图：</p><blockquote><p>redux 中习惯将 reducer 函数命名为为和被更新的 state 字段相同，这样直观且方便工具处理。</p></blockquote><p><img loading="lazy" src="/assets/images/combine-reducer-7ecfd5eaffcf44107c938fb96103c130.png" width="897" height="343" class="img_cbWx"></p><p>这差不多就是 Redux 思想的全部。几乎没有介绍到 Redux 的 API，Redux 90% 的是思想，这部分都是纯 JavaScript 代码。</p><h2 class="anchor anchorWithStickyNavbar__8zn" id="redux-api">Redux API<a href="#redux-api" class="hash-link" aria-label="Direct link to Redux API" title="Direct link to Redux API">​</a></h2><p>上面一节已经将 redux 的核心思想介绍完了，唯一缺失的部分是，如何连接各个部分：View 如何发送 action、action 如何传递给 reducer 处理，更新 state 后如何通知 View 更新。这部分可以基于事件的发布-订阅完成，实际上 redux 的 API 也确实是这样实现的。</p><p>Redux 的 API 主要是提供了 Store，它的作用就是将这几个概念串联起来。Store 有以下职责：</p><ul><li>内部维持应用的 state 和 reducer；</li><li>提供<code>getState()</code>方法获取 state；</li><li>提供<code>dispatch(action)</code>方法更新 state；</li><li>通过<code>subscribe(listener)</code>注册监听器;</li></ul><div class="language-javascript codeBlockContainer_y2BJ theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_sTVe"><pre tabindex="0" class="prism-code language-javascript codeBlock_E3kc thin-scrollbar"><code class="codeBlockLines_onph"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports punctuation" style="color:#393A34">{</span><span class="token imports"> createStore </span><span class="token imports punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;redux&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 应用的初始状态</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> initialState </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">todos</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">visibilityFilter</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;SHOW_ALL&#x27;</span><span class="token plain"> </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 创建 store 时传入 reducer 和应用的初始 state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> store </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">createStore</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">todoApp</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> initialState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 用户与 View 发生交互行时，发送 action 更新应用 state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">store</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">dispatch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;ADD_TODO&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">text</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;Go to swimming pool&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 订阅 state 变化事件</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">store</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">onStateUpdate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 更新 View</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">renderUI</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">store</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup_VXKq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_lm29" aria-hidden="true"><svg class="copyButtonIcon_ASo7" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_WQFn" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>redux 的核心 API 源码非常短（加上注释 250 左右），感兴趣可以看 <a href="https://github.com/reactjs/redux/blob/master/src/createStore.js" target="_blank" rel="noopener noreferrer">createStore 源码</a>，redux 的其他几个 API 接口都是为了简化 action 和 reducer 的创建，以及支持 middleware，并不影响到 redux 的核心。</p><h2 class="anchor anchorWithStickyNavbar__8zn" id="redux-三大原则">Redux 三大原则<a href="#redux-三大原则" class="hash-link" aria-label="Direct link to Redux 三大原则" title="Direct link to Redux 三大原则">​</a></h2><p>使用 redux 应当始终遵循下面介绍的三个原则，这将会提高代码的可维护性、开发效率和其他方面的好处。下面的三大原则描述来自 redux 文档（我只是搬运工），略微进行简化。</p><p><strong>单一数据源</strong></p><p>整个应用的 state 被储存在一棵对象数中，并且这个对象树只存在于唯一一个 store 中。</p><p>单一数据源在调试时非常方便，因为任意时刻，你都可以获取到整个应用当前的 state 快照。</p><p><strong>state 是只读的</strong></p><p>唯一改变 state 的方法就是触发 action</p><p>这样可以确保 View 的交互事件、网络请求等都不能直接修改 state，相反它们只能表达修改的意图，所有的修改都被集中化处理，且严格按照一个接一个的顺序执行，因此不用担心条件竞争导致的时序问题。</p><p>同时，由于 action 是一个纯 JavaScript 对象，打印出 action 就可以清晰的看到应用程序的状态变迁图，这对于调试和回溯非常方便。</p><p><strong>reducer 是纯函数</strong></p><p>reducer 是纯函数，意味着它并不直接修改 state，而是在 state 的副本上进行修改，并返回副本。同时，由于 reducer 是纯函数，所以 reducer 内部不能发起网络请求、不能修改外部变量等引起副作用的行为。</p><p>之所以这么不遗余力的要保持 reducer 的纯函数特性，是为了保持 state 的变化只受 action 影响，不依赖于其他外部因素，让 state 的变化可预测。</p><h2 class="anchor anchorWithStickyNavbar__8zn" id="示例--源码">示例 &amp; 源码<a href="#示例--源码" class="hash-link" aria-label="Direct link to 示例 &amp; 源码" title="Direct link to 示例 &amp; 源码">​</a></h2><p>Online demo: <a href="https://whinc.github.io/redux-todos-demo/" target="_blank" rel="noopener noreferrer">https://whinc.github.io/redux-todos-demo/</a></p><p>Github source code: <a href="https://github.com/whinc/redux-todos-demo" target="_blank" rel="noopener noreferrer">https://github.com/whinc/redux-todos-demo</a></p><h2 class="anchor anchorWithStickyNavbar__8zn" id="参考">参考<a href="#参考" class="hash-link" aria-label="Direct link to 参考" title="Direct link to 参考">​</a></h2><ul><li><a href="http://cn.redux.js.org/index.html" target="_blank" rel="noopener noreferrer">redux 中文文档</a></li><li><a href="http://imweb.io/topic/57711e37f0a5487b05f325b5" target="_blank" rel="noopener noreferrer">浅谈 React、Flux 与 Redux</a></li></ul></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_Cs98"><div class="col margin-top--sm"><a href="https://github.com/whinc/whinc.github.io/tree/master/website/blog/2018/02-26-understand-redux-in-10min/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit__bKI" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/2018/03/16/name-program-variable"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">程序变量命名的几种叫法</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/2018/02/25/implement-promise"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">自己动手实现 ES6 Promise</div></a></nav></main><div class="col col--2"><div class="tableOfContents_pd5v thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#redux-是什么" class="table-of-contents__link toc-highlight">redux 是什么？</a></li><li><a href="#redux-核心概念" class="table-of-contents__link toc-highlight">redux 核心概念</a></li><li><a href="#redux-api" class="table-of-contents__link toc-highlight">Redux API</a></li><li><a href="#redux-三大原则" class="table-of-contents__link toc-highlight">Redux 三大原则</a></li><li><a href="#示例--源码" class="table-of-contents__link toc-highlight">示例 &amp; 源码</a></li><li><a href="#参考" class="table-of-contents__link toc-highlight">参考</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 <a href="https://github.com/whinc" target="_blank">whincwu(右耳朵猫)</a>
          <br>站点使用 <a href="https://docusaurus.io/" target="_blank">Docusaurus</a> 构建</div></div></div></footer></div>
<script src="/assets/js/runtime~main.1dbb5de3.js"></script>
<script src="/assets/js/main.2d289e26.js"></script>
</body>
</html>