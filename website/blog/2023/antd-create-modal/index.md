---
tags: ["antd", "react"]
keywords: ["antd", "modal"]
---

# Antd 弹窗封装

在 Antd 中弹窗的使用频率很高，简单的展示弹窗使用[Modal.method()](<https://4x.ant.design/components/modal-cn/#Modal.method()>)即可，复杂的弹窗的弹窗则需要自定义弹窗，以便控制弹窗的显示和隐藏，以及数据交互。

## 第一版

下面是我封装的第一版弹窗，弹窗通过暴露 ref 引用，让外部控制弹窗的显示，以及传递数据给弹窗容，通过回调函数将弹窗内部的处理结果传递给外部。

import Demo1 from './demo1';

<Demo1/>

## 第二版

基于上面弹窗的封装模式，根据需要可以进一步扩展，基本能满足大部分弹窗使用场景了。但是上面封装方式有不少样板代码，每次写个弹窗有不少重复工作，于是将对弹窗的封装模式剥离出来形成一个独立的函数`createModal`，这样可以大大减少样板代码，聚焦于编写弹窗的内容和交互逻辑。

下面是基于 `createModal` 创建弹窗的示例，可以看到弹窗的源码已经减少到一行代码了，写弹窗时只需要关注于弹窗的内容区域，使用弹窗时也无需创建 ref 来引用弹窗，而是通过弹窗上暴露的静态方法`MyModal.show()`显示弹窗和传参。

import Demo2 from './demo2';

<Demo2/>

经过`createModal`封装后，业务层只需关注弹窗的内容（即`<Modal>`的子组件），无需处理弹窗与内容的交互。 那使用时如何控制弹窗的交互呢？例如点击确认时获取弹窗中的表单内容、点击确认时弹窗按钮显示 loading 效果等。

答案是通过弹窗暴露的静态方法`MyModal.show()`实现，请看下面例子，通过 `state/setState`可以在弹窗组件内部存储状态，通过 ref 可以调用弹窗内容组件暴露的方法。

import Demo3 from './demo3';

<Demo3/>

## 小结

Antd 的弹窗功能很多，但是在实际使用时还是需要做不少工作，通过封装 Antd 的弹窗，大大简化了弹窗的处理逻辑，让业务层专注于弹窗的内容逻辑。
